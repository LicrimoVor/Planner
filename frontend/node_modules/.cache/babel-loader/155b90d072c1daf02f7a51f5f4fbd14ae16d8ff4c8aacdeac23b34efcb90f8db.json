{"ast":null,"code":"import Cookies from \"js-cookie\";\nimport { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\nclass SessionStore {\n  constructor() {\n    this.store = void 0;\n    this.useSession = () => this.store(state => !!state.session);\n    this.setUser = session => this.store.getState().setUser(session);\n    this.removeUser = () => this.store.getState().removeUser();\n    this.store = create()(persist((set, get) => ({\n      session: null,\n      setUser: session => {\n        set({\n          session: session\n        });\n      },\n      removeUser: () => {\n        set({\n          session: null\n        });\n      }\n    }), {\n      name: \"sessionStorage\",\n      onRehydrateStorage: () => state => {\n        const session = Cookies.get(\"sessionid\");\n        if (state !== null && state !== void 0 && state.session) {\n          state.setUser(session || null);\n        }\n        console.log(\"rehydrate\", state);\n      }\n    }));\n  }\n}\nexport const sessionStore = new SessionStore();","map":{"version":3,"names":["Cookies","create","persist","SessionStore","constructor","store","useSession","state","session","setUser","getState","removeUser","set","get","name","onRehydrateStorage","console","log","sessionStore"],"sources":["D:/Mega/Planner/frontend/src/entities/session/store.ts"],"sourcesContent":["import Cookies from \"js-cookie\";\r\nimport {create} from \"zustand\";\r\nimport {persist} from \"zustand/middleware\";\r\nimport {IUser} from \"@entities/user/api/models\";\r\n\r\ninterface ISessionState {\r\n    session: string | null;\r\n    user: IUser | null;\r\n\r\n    setUser: (session: string | null) => void;\r\n    removeUser: () => void;\r\n}\r\n\r\nclass SessionStore {\r\n    private store;\r\n\r\n    constructor() {\r\n        this.store = create<ISessionState>()(\r\n            persist(\r\n                (set, get) => ({\r\n                    session: null,\r\n\r\n                    setUser: (session: string | null) => {\r\n                        set({session: session});\r\n                    },\r\n\r\n                    removeUser: () => {\r\n                        set({session: null});\r\n                    }\r\n                }),\r\n                {\r\n                    name: \"sessionStorage\",\r\n                    onRehydrateStorage: () => state => {\r\n                        const session = Cookies.get(\"sessionid\");\r\n\r\n                        if(state?.session) {\r\n                            state.setUser(session || null);\r\n                        }\r\n\r\n                        console.log(\"rehydrate\", state);\r\n                    }\r\n                }\r\n            )\r\n        );\r\n    }\r\n\r\n    useSession = () => this.store(state => !!state.session);\r\n    setUser = (session: string | null) => this.store.getState().setUser(session);\r\n    removeUser = () => this.store.getState().removeUser();\r\n}\r\n\r\nexport const sessionStore = new SessionStore();"],"mappings":"AAAA,OAAOA,OAAO,MAAM,WAAW;AAC/B,SAAQC,MAAM,QAAO,SAAS;AAC9B,SAAQC,OAAO,QAAO,oBAAoB;AAW1C,MAAMC,YAAY,CAAC;EAGfC,WAAWA,CAAA,EAAG;IAAA,KAFNC,KAAK;IAAA,KAgCbC,UAAU,GAAG,MAAM,IAAI,CAACD,KAAK,CAACE,KAAK,IAAI,CAAC,CAACA,KAAK,CAACC,OAAO,CAAC;IAAA,KACvDC,OAAO,GAAID,OAAsB,IAAK,IAAI,CAACH,KAAK,CAACK,QAAQ,CAAC,CAAC,CAACD,OAAO,CAACD,OAAO,CAAC;IAAA,KAC5EG,UAAU,GAAG,MAAM,IAAI,CAACN,KAAK,CAACK,QAAQ,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC;IA/BjD,IAAI,CAACN,KAAK,GAAGJ,MAAM,CAAgB,CAAC,CAChCC,OAAO,CACH,CAACU,GAAG,EAAEC,GAAG,MAAM;MACXL,OAAO,EAAE,IAAI;MAEbC,OAAO,EAAGD,OAAsB,IAAK;QACjCI,GAAG,CAAC;UAACJ,OAAO,EAAEA;QAAO,CAAC,CAAC;MAC3B,CAAC;MAEDG,UAAU,EAAEA,CAAA,KAAM;QACdC,GAAG,CAAC;UAACJ,OAAO,EAAE;QAAI,CAAC,CAAC;MACxB;IACJ,CAAC,CAAC,EACF;MACIM,IAAI,EAAE,gBAAgB;MACtBC,kBAAkB,EAAEA,CAAA,KAAMR,KAAK,IAAI;QAC/B,MAAMC,OAAO,GAAGR,OAAO,CAACa,GAAG,CAAC,WAAW,CAAC;QAExC,IAAGN,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEC,OAAO,EAAE;UACfD,KAAK,CAACE,OAAO,CAACD,OAAO,IAAI,IAAI,CAAC;QAClC;QAEAQ,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEV,KAAK,CAAC;MACnC;IACJ,CACJ,CACJ,CAAC;EACL;AAKJ;AAEA,OAAO,MAAMW,YAAY,GAAG,IAAIf,YAAY,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}