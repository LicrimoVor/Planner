{"ast":null,"code":"import axios from \"axios\";\nimport Cookies from \"js-cookie\";\nimport { API_URL } from \"@shared/config\";\nclass ApiInstance {\n  constructor() {\n    this.axios = void 0;\n    this.axios = axios.create({\n      withCredentials: true,\n      baseURL: API_URL,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      xsrfHeaderName: \"X-CSRFToken\"\n    });\n    this.axios.interceptors.request.use(config => {\n      if (config.method.toLowerCase() === \"post\") {\n        const token = Cookies.get(\"csrftoken\");\n        if (token) {\n          config.headers.set(config.xsrfHeaderName, token);\n        }\n      }\n      return config;\n    });\n    this.axios.interceptors.response.use(response => {\n      return response;\n    }, error => {\n      var _error$response;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n        if (Cookies.get(\"sessionid\")) {\n          Cookies.remove(\"sessionid\");\n        }\n        if (Cookies.get(\"csrftoken\")) {\n          Cookies.remove(\"csrftoken\");\n        }\n      }\n    });\n  }\n  async get(endpoint, options = {}) {\n    try {\n      const response = await this.axios.get(endpoint, options);\n      return response.data;\n    } catch (error) {\n      throw error;\n    }\n  }\n  async post(endpoint, data, options = {}) {\n    try {\n      const response = await this.axios.post(endpoint, data, options);\n      return response.data;\n    } catch (error) {\n      console.log(error);\n      throw error;\n    }\n  }\n  async patch(endpoint, data, options = {}) {\n    try {\n      const response = await this.axios.patch(endpoint, data, options);\n      return response.data;\n    } catch (error) {\n      throw error;\n    }\n  }\n  async redirect(endpoint) {\n    // console.log(\"redirect\", url);\n    window.location.href = API_URL + endpoint;\n  }\n}\nexport const apiInstance = new ApiInstance();","map":{"version":3,"names":["axios","Cookies","API_URL","ApiInstance","constructor","create","withCredentials","baseURL","headers","xsrfHeaderName","interceptors","request","use","config","method","toLowerCase","token","get","set","response","error","_error$response","status","remove","endpoint","options","data","post","console","log","patch","redirect","window","location","href","apiInstance"],"sources":["D:/Mega/Planner/frontend/src/shared/api/base.ts"],"sourcesContent":["import axios, {\r\n    Axios, AxiosError,\r\n    AxiosInstance,\r\n    AxiosRequestConfig,\r\n    AxiosResponse, InternalAxiosRequestConfig,\r\n} from \"axios\";\r\nimport Cookies from \"js-cookie\";\r\nimport {API_URL} from \"@shared/config\";\r\n\r\nclass ApiInstance {\r\n    private axios: AxiosInstance;\r\n\r\n    constructor() {\r\n        this.axios = axios.create({\r\n            withCredentials: true,\r\n            baseURL: API_URL,\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            xsrfHeaderName: \"X-CSRFToken\"\r\n        });\r\n\r\n        this.axios.interceptors.request.use((config: InternalAxiosRequestConfig) => {\r\n            if(config.method!.toLowerCase() === \"post\") {\r\n                const token = Cookies.get(\"csrftoken\");\r\n                if(token) {\r\n                    config.headers.set(config.xsrfHeaderName, token);\r\n                }\r\n            }\r\n\r\n            return config;\r\n        });\r\n\r\n        this.axios.interceptors.response.use((response: AxiosResponse) => {\r\n            return response;\r\n        }, (error: AxiosError) => {\r\n            if(error.response?.status === 401) {\r\n                if(Cookies.get(\"sessionid\")) {\r\n                    Cookies.remove(\"sessionid\");\r\n                }\r\n                if(Cookies.get(\"csrftoken\")) {\r\n                    Cookies.remove(\"csrftoken\");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    async get<T>(endpoint: string, options: AxiosRequestConfig = {}): Promise<T> {\r\n        try {\r\n            const response: AxiosResponse<T> = await this.axios.get(\r\n                endpoint,\r\n                options\r\n            );\r\n            return response.data;\r\n        }\r\n        catch (error) {\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async post<T>(endpoint: string, data: any, options: AxiosRequestConfig = {}): Promise<T> {\r\n        try {\r\n            const response: AxiosResponse<T> = await this.axios.post(\r\n                endpoint,\r\n                data,\r\n                options\r\n            );\r\n            return response.data;\r\n        }\r\n        catch (error) {\r\n            console.log(error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async patch<T>(endpoint: string, data: any, options: AxiosRequestConfig = {}): Promise<T> {\r\n        try {\r\n            const response: AxiosResponse<T> = await this.axios.patch(\r\n                endpoint,\r\n                data,\r\n                options\r\n            );\r\n            return response.data;\r\n        }\r\n        catch (error) {\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async redirect(endpoint: string): Promise<void> {\r\n        // console.log(\"redirect\", url);\r\n        window.location.href = API_URL + endpoint;\r\n    }\r\n}\r\n\r\nexport const apiInstance = new ApiInstance();"],"mappings":"AAAA,OAAOA,KAAK,MAKL,OAAO;AACd,OAAOC,OAAO,MAAM,WAAW;AAC/B,SAAQC,OAAO,QAAO,gBAAgB;AAEtC,MAAMC,WAAW,CAAC;EAGdC,WAAWA,CAAA,EAAG;IAAA,KAFNJ,KAAK;IAGT,IAAI,CAACA,KAAK,GAAGA,KAAK,CAACK,MAAM,CAAC;MACtBC,eAAe,EAAE,IAAI;MACrBC,OAAO,EAAEL,OAAO;MAChBM,OAAO,EAAE;QACL,cAAc,EAAE;MACpB,CAAC;MACDC,cAAc,EAAE;IACpB,CAAC,CAAC;IAEF,IAAI,CAACT,KAAK,CAACU,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAkC,IAAK;MACxE,IAAGA,MAAM,CAACC,MAAM,CAAEC,WAAW,CAAC,CAAC,KAAK,MAAM,EAAE;QACxC,MAAMC,KAAK,GAAGf,OAAO,CAACgB,GAAG,CAAC,WAAW,CAAC;QACtC,IAAGD,KAAK,EAAE;UACNH,MAAM,CAACL,OAAO,CAACU,GAAG,CAACL,MAAM,CAACJ,cAAc,EAAEO,KAAK,CAAC;QACpD;MACJ;MAEA,OAAOH,MAAM;IACjB,CAAC,CAAC;IAEF,IAAI,CAACb,KAAK,CAACU,YAAY,CAACS,QAAQ,CAACP,GAAG,CAAEO,QAAuB,IAAK;MAC9D,OAAOA,QAAQ;IACnB,CAAC,EAAGC,KAAiB,IAAK;MAAA,IAAAC,eAAA;MACtB,IAAG,EAAAA,eAAA,GAAAD,KAAK,CAACD,QAAQ,cAAAE,eAAA,uBAAdA,eAAA,CAAgBC,MAAM,MAAK,GAAG,EAAE;QAC/B,IAAGrB,OAAO,CAACgB,GAAG,CAAC,WAAW,CAAC,EAAE;UACzBhB,OAAO,CAACsB,MAAM,CAAC,WAAW,CAAC;QAC/B;QACA,IAAGtB,OAAO,CAACgB,GAAG,CAAC,WAAW,CAAC,EAAE;UACzBhB,OAAO,CAACsB,MAAM,CAAC,WAAW,CAAC;QAC/B;MACJ;IACJ,CAAC,CAAC;EACN;EAEA,MAAMN,GAAGA,CAAIO,QAAgB,EAAEC,OAA2B,GAAG,CAAC,CAAC,EAAc;IACzE,IAAI;MACA,MAAMN,QAA0B,GAAG,MAAM,IAAI,CAACnB,KAAK,CAACiB,GAAG,CACnDO,QAAQ,EACRC,OACJ,CAAC;MACD,OAAON,QAAQ,CAACO,IAAI;IACxB,CAAC,CACD,OAAON,KAAK,EAAE;MACV,MAAMA,KAAK;IACf;EACJ;EAEA,MAAMO,IAAIA,CAAIH,QAAgB,EAAEE,IAAS,EAAED,OAA2B,GAAG,CAAC,CAAC,EAAc;IACrF,IAAI;MACA,MAAMN,QAA0B,GAAG,MAAM,IAAI,CAACnB,KAAK,CAAC2B,IAAI,CACpDH,QAAQ,EACRE,IAAI,EACJD,OACJ,CAAC;MACD,OAAON,QAAQ,CAACO,IAAI;IACxB,CAAC,CACD,OAAON,KAAK,EAAE;MACVQ,OAAO,CAACC,GAAG,CAACT,KAAK,CAAC;MAClB,MAAMA,KAAK;IACf;EACJ;EAEA,MAAMU,KAAKA,CAAIN,QAAgB,EAAEE,IAAS,EAAED,OAA2B,GAAG,CAAC,CAAC,EAAc;IACtF,IAAI;MACA,MAAMN,QAA0B,GAAG,MAAM,IAAI,CAACnB,KAAK,CAAC8B,KAAK,CACrDN,QAAQ,EACRE,IAAI,EACJD,OACJ,CAAC;MACD,OAAON,QAAQ,CAACO,IAAI;IACxB,CAAC,CACD,OAAON,KAAK,EAAE;MACV,MAAMA,KAAK;IACf;EACJ;EAEA,MAAMW,QAAQA,CAACP,QAAgB,EAAiB;IAC5C;IACAQ,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAGhC,OAAO,GAAGsB,QAAQ;EAC7C;AACJ;AAEA,OAAO,MAAMW,WAAW,GAAG,IAAIhC,WAAW,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}