{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { create } from \"zustand\";\nimport { API_META } from \"@shared/api\";\nimport { AuthService, UserStore } from \"@entities/user\";\nimport Cookies from \"js-cookie\";\nconst useAuthStore = create((set, get) => ({\n  meta: API_META.INITIAL,\n  isAuth: false,\n  login: async params => {\n    useQuery;\n    if (get().meta === API_META.LOADING) {\n      return;\n    }\n    set({\n      meta: API_META.LOADING\n    });\n    try {\n      const response = await AuthService.login(params);\n      set({\n        isAuth: true,\n        meta: API_META.SUCCESS\n      });\n    } catch (error) {\n      set({\n        meta: API_META.ERROR\n      });\n    }\n  },\n  logout: async () => {\n    if (get().meta === API_META.LOADING) {\n      return;\n    }\n    set({\n      meta: API_META.LOADING\n    });\n    try {\n      await AuthService.logout();\n      set({\n        isAuth: false,\n        meta: API_META.SUCCESS\n      });\n    } catch (error) {\n      set({\n        meta: API_META.ERROR\n      });\n    }\n  },\n  check: async () => {\n    if (get().meta === API_META.LOADING) {\n      return;\n    }\n    set({\n      meta: API_META.LOADING\n    });\n    if (!Cookies.get(\"sessionid\")) {\n      set({\n        isAuth: false,\n        meta: API_META.ERROR\n      });\n      return;\n    }\n    try {\n      await UserStore.getMe();\n      set({\n        isAuth: true,\n        meta: API_META.SUCCESS\n      });\n    } catch {\n      set({\n        isAuth: false,\n        meta: API_META.ERROR\n      });\n    }\n  }\n}));\nexport class AuthStore {}\nAuthStore.useMeta = _s(() => {\n  _s();\n  return useAuthStore(state => state.meta);\n}, \"BSK3XewfuZPixDP8tbzcobpulFc=\", false, function () {\n  return [useAuthStore];\n});\nAuthStore.useAuth = _s2(() => {\n  _s2();\n  return useAuthStore(state => state.isAuth);\n}, \"BSK3XewfuZPixDP8tbzcobpulFc=\", false, function () {\n  return [useAuthStore];\n});\nAuthStore.login = useAuthStore.getState().login;\nAuthStore.logout = useAuthStore.getState().logout;\nAuthStore.check = useAuthStore.getState().check;","map":{"version":3,"names":["create","API_META","AuthService","UserStore","Cookies","useAuthStore","set","get","meta","INITIAL","isAuth","login","params","useQuery","LOADING","response","SUCCESS","error","ERROR","logout","check","getMe","AuthStore","useMeta","_s","state","useAuth","_s2","getState"],"sources":["D:/Mega/Planner/frontend/src/entities/user/auth/store.ts"],"sourcesContent":["import {create, StoreApi, UseBoundStore} from \"zustand\";\r\nimport {API_META} from \"@shared/api\";\r\nimport {AuthService, ILoginParams, UserStore} from \"@entities/user\";\r\nimport Cookies from \"js-cookie\";\r\n\r\ninterface AuthState {\r\n    meta: API_META;\r\n    isAuth: boolean;\r\n\r\n    login: (params: ILoginParams) => Promise<void>;\r\n    logout: () => Promise<void>;\r\n    check: () => Promise<void>;\r\n}\r\n\r\nconst useAuthStore = create<AuthState>((set, get) => ({\r\n    meta: API_META.INITIAL,\r\n    isAuth: false,\r\n\r\n    login: async (params) => {\r\n        useQuery\r\n\r\n        if(get().meta === API_META.LOADING) {\r\n            return;\r\n        }\r\n\r\n        set({meta: API_META.LOADING});\r\n\r\n        try {\r\n            const response = await AuthService.login(params);\r\n            set({isAuth: true, meta: API_META.SUCCESS});\r\n        }\r\n        catch (error) {\r\n            set({meta: API_META.ERROR});\r\n        }\r\n    },\r\n\r\n    logout: async () => {\r\n        if(get().meta === API_META.LOADING) {\r\n            return;\r\n        }\r\n\r\n        set({meta: API_META.LOADING});\r\n\r\n        try {\r\n            await AuthService.logout();\r\n            set({isAuth: false, meta: API_META.SUCCESS});\r\n        }\r\n        catch (error) {\r\n            set({meta: API_META.ERROR});\r\n        }\r\n    },\r\n\r\n    check: async () => {\r\n        if(get().meta === API_META.LOADING) {\r\n            return;\r\n        }\r\n\r\n        set({meta: API_META.LOADING});\r\n\r\n        if(!Cookies.get(\"sessionid\")) {\r\n            set({isAuth: false, meta: API_META.ERROR});\r\n            return;\r\n        }\r\n\r\n        try {\r\n            await UserStore.getMe();\r\n            set({isAuth: true, meta: API_META.SUCCESS});\r\n        }\r\n        catch {\r\n            set({isAuth: false, meta: API_META.ERROR});\r\n        }\r\n    }\r\n}));\r\n\r\nexport class AuthStore {\r\n    static useMeta = () => useAuthStore(state => state.meta);\r\n    static useAuth = () => useAuthStore(state => state.isAuth);\r\n\r\n    static login = useAuthStore.getState().login;\r\n    static logout = useAuthStore.getState().logout;\r\n    static check = useAuthStore.getState().check;\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}