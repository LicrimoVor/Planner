{"ast":null,"code":"var _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { create } from \"zustand\";\nimport { API_META } from \"@shared/api\";\nimport { persist } from \"zustand/middleware\";\nconst useAuthStore = create()(persist((set, get) => ({\n  meta: API_META.INITIAL,\n  // isAuth: false,\n\n  session: null\n\n  // login: async (params) => {\n  //     if(get().meta === API_META.LOADING) {\n  //         return;\n  //     }\n  //\n  //     set({meta: API_META.LOADING});\n  //\n  //     try {\n  //         await AuthService.login(params);\n  //         const session = Cookies.get(\"sessionid\");\n  //         set({session: session});\n  //         set({isAuth: true, meta: API_META.SUCCESS});\n  //     }\n  //     catch (error) {\n  //         set({meta: API_META.ERROR});\n  //         throw new Error(\"Неверный логин или пароль\");\n  //     }\n  // },\n  //\n  // logout: async () => {\n  //     if(get().meta === API_META.LOADING) {\n  //         return;\n  //     }\n  //\n  //     set({meta: API_META.LOADING});\n  //\n  //     try {\n  //         await AuthService.logout();\n  //         set({session: null});\n  //         set({isAuth: false, meta: API_META.SUCCESS});\n  //     }\n  //     catch (error) {\n  //         set({meta: API_META.ERROR});\n  //     }\n  // },\n  //\n  // check: async () => {\n  //     if(get().meta === API_META.LOADING) {\n  //         return;\n  //     }\n  //\n  //     set({meta: API_META.LOADING});\n  //\n  //     if(!Cookies.get(\"sessionid\")) {\n  //         set({isAuth: false, meta: API_META.ERROR});\n  //         return;\n  //     }\n  //\n  //     try {\n  //         await UserStore.getMe();\n  //         set({isAuth: true, meta: API_META.SUCCESS});\n  //     }\n  //     catch {\n  //         set({isAuth: false, meta: API_META.ERROR});\n  //     }\n  // },\n  //\n  // useTest: () => useQuery({\n  //     queryKey: [],\n  //\n  //     queryFn: async () => {\n  //         console.log(\"call query\");\n  //         const response = await UserService.getMe();\n  //\n  //         return response;\n  //     }\n  // }\n}), {\n  name: \"session-storage\"\n}));\nexport class AuthStore {}\nAuthStore.useSession = useAuthStore.getState().session;\nAuthStore.useMeta = _s(() => {\n  _s();\n  return useAuthStore(state => state.meta);\n}, \"BSK3XewfuZPixDP8tbzcobpulFc=\", false, function () {\n  return [useAuthStore];\n});\nAuthStore.useAuth = _s2(() => {\n  _s2();\n  return useAuthStore(state => state.isAuth);\n}, \"BSK3XewfuZPixDP8tbzcobpulFc=\", false, function () {\n  return [useAuthStore];\n});\nAuthStore.login = useAuthStore.getState().login;\nAuthStore.logout = useAuthStore.getState().logout;\nAuthStore.check = useAuthStore.getState().check;","map":{"version":3,"names":["create","API_META","persist","useAuthStore","set","get","meta","INITIAL","session","name","AuthStore","useSession","getState","useMeta","_s","state","useAuth","_s2","isAuth","login","logout","check"],"sources":["D:/Mega/Planner/frontend/src/entities/user/auth/store.ts"],"sourcesContent":["import {create} from \"zustand\";\r\nimport {API_META} from \"@shared/api\";\r\nimport {AuthService, ILoginParams, UserService, UserStore} from \"@entities/user\";\r\nimport Cookies from \"js-cookie\";\r\nimport {useQuery, UseQueryResult} from \"@tanstack/react-query\";\r\nimport {persist} from \"zustand/middleware\";\r\n\r\ninterface AuthState {\r\n    meta: API_META;\r\n    // isAuth: boolean;\r\n\r\n    session: string | null;\r\n    //\r\n    // login: (params: ILoginParams) => Promise<void>;\r\n    // logout: () => Promise<void>;\r\n    // check: () => Promise<void>;\r\n}\r\n\r\nconst useAuthStore = create<AuthState>()(\r\n    persist(\r\n        (set, get) => ({\r\n            meta: API_META.INITIAL,\r\n            // isAuth: false,\r\n\r\n            session: null,\r\n\r\n            // login: async (params) => {\r\n            //     if(get().meta === API_META.LOADING) {\r\n            //         return;\r\n            //     }\r\n            //\r\n            //     set({meta: API_META.LOADING});\r\n            //\r\n            //     try {\r\n            //         await AuthService.login(params);\r\n            //         const session = Cookies.get(\"sessionid\");\r\n            //         set({session: session});\r\n            //         set({isAuth: true, meta: API_META.SUCCESS});\r\n            //     }\r\n            //     catch (error) {\r\n            //         set({meta: API_META.ERROR});\r\n            //         throw new Error(\"Неверный логин или пароль\");\r\n            //     }\r\n            // },\r\n            //\r\n            // logout: async () => {\r\n            //     if(get().meta === API_META.LOADING) {\r\n            //         return;\r\n            //     }\r\n            //\r\n            //     set({meta: API_META.LOADING});\r\n            //\r\n            //     try {\r\n            //         await AuthService.logout();\r\n            //         set({session: null});\r\n            //         set({isAuth: false, meta: API_META.SUCCESS});\r\n            //     }\r\n            //     catch (error) {\r\n            //         set({meta: API_META.ERROR});\r\n            //     }\r\n            // },\r\n            //\r\n            // check: async () => {\r\n            //     if(get().meta === API_META.LOADING) {\r\n            //         return;\r\n            //     }\r\n            //\r\n            //     set({meta: API_META.LOADING});\r\n            //\r\n            //     if(!Cookies.get(\"sessionid\")) {\r\n            //         set({isAuth: false, meta: API_META.ERROR});\r\n            //         return;\r\n            //     }\r\n            //\r\n            //     try {\r\n            //         await UserStore.getMe();\r\n            //         set({isAuth: true, meta: API_META.SUCCESS});\r\n            //     }\r\n            //     catch {\r\n            //         set({isAuth: false, meta: API_META.ERROR});\r\n            //     }\r\n            // },\r\n            //\r\n            // useTest: () => useQuery({\r\n            //     queryKey: [],\r\n            //\r\n            //     queryFn: async () => {\r\n            //         console.log(\"call query\");\r\n            //         const response = await UserService.getMe();\r\n            //\r\n            //         return response;\r\n            //     }\r\n            // }\r\n\r\n        }), {\r\n            name: \"session-storage\",\r\n        }\r\n));\r\n\r\nexport class AuthStore {\r\n    static useSession = useAuthStore.getState().session;\r\n    static useMeta = () => useAuthStore(state => state.meta);\r\n    static useAuth = () => useAuthStore(state => state.isAuth);\r\n\r\n    static login = useAuthStore.getState().login;\r\n    static logout = useAuthStore.getState().logout;\r\n    static check = useAuthStore.getState().check;\r\n}"],"mappings":";;AAAA,SAAQA,MAAM,QAAO,SAAS;AAC9B,SAAQC,QAAQ,QAAO,aAAa;AAIpC,SAAQC,OAAO,QAAO,oBAAoB;AAa1C,MAAMC,YAAY,GAAGH,MAAM,CAAY,CAAC,CACpCE,OAAO,CACH,CAACE,GAAG,EAAEC,GAAG,MAAM;EACXC,IAAI,EAAEL,QAAQ,CAACM,OAAO;EACtB;;EAEAC,OAAO,EAAE;;EAET;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AAEJ,CAAC,CAAC,EAAE;EACAC,IAAI,EAAE;AACV,CACR,CAAC,CAAC;AAEF,OAAO,MAAMC,SAAS,CAAC;AAAVA,SAAS,CACXC,UAAU,GAAGR,YAAY,CAACS,QAAQ,CAAC,CAAC,CAACJ,OAAO;AAD1CE,SAAS,CAEXG,OAAO,GAAAC,EAAA,CAAG;EAAAA,EAAA;EAAA,OAAMX,YAAY,CAACY,KAAK,IAAIA,KAAK,CAACT,IAAI,CAAC;AAAA;EAAA,QAAjCH,YAAY;AAAA;AAF1BO,SAAS,CAGXM,OAAO,GAAAC,GAAA,CAAG;EAAAA,GAAA;EAAA,OAAMd,YAAY,CAACY,KAAK,IAAIA,KAAK,CAACG,MAAM,CAAC;AAAA;EAAA,QAAnCf,YAAY;AAAA;AAH1BO,SAAS,CAKXS,KAAK,GAAGhB,YAAY,CAACS,QAAQ,CAAC,CAAC,CAACO,KAAK;AALnCT,SAAS,CAMXU,MAAM,GAAGjB,YAAY,CAACS,QAAQ,CAAC,CAAC,CAACQ,MAAM;AANrCV,SAAS,CAOXW,KAAK,GAAGlB,YAAY,CAACS,QAAQ,CAAC,CAAC,CAACS,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}