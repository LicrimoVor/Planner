{"ast":null,"code":"var _class,\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { PersonalTaskService } from \"@entities/task\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nexport const PERSONAL_TASK_QUERIES = {\n  TASKS: \"personalTasks\",\n  SUBTASKS: \"personalSubtasks\"\n};\nexport class PersonalTaskRepository {}\n_class = PersonalTaskRepository;\nPersonalTaskRepository.keys = {\n  root: [\"personalTasks\"],\n  task: {\n    root: () => [..._class.keys.root, \"task\"],\n    id: id => [..._class.keys.task.root(), id]\n  },\n  mutation: {\n    create: () => [..._class.keys.root, \"create\"],\n    delete: () => [..._class.keys.root, \"delete\"],\n    update: () => [..._class.keys.root, \"update\"]\n  }\n};\nPersonalTaskRepository.getList = _s(params => {\n  _s();\n  return useQuery({\n    queryKey: _class.keys.root,\n    queryFn: async () => {\n      const response = await PersonalTaskService.getList(params);\n      await new Promise(resolve => setTimeout(resolve, 500));\n      return response;\n    }\n  });\n}, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nPersonalTaskRepository.updateTask = _s2(queryClient => {\n  _s2();\n  return useMutation({\n    mutationKey: _class.keys.mutation.create(),\n    mutationFn: async ({\n      taskId,\n      task\n    }) => {\n      const response = await PersonalTaskService.updateTask(taskId, task);\n      return response;\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({\n        queryKey: _class.keys.root\n      });\n    },\n    onMutate: () => {\n      console.log(\"mutate\");\n    }\n  });\n}, \"wwwtpB20p0aLiHIvSy5P98MwIUg=\", false, function () {\n  return [useMutation];\n});\nPersonalTaskRepository.getSubtasks = _s3(task_id => {\n  _s3();\n  return useQuery({\n    queryKey: [PERSONAL_TASK_QUERIES.SUBTASKS],\n    queryFn: async () => {\n      const response = await PersonalTaskService.getSubtasks(task_id);\n      return response;\n    }\n  });\n}, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});","map":{"version":3,"names":["PersonalTaskService","useMutation","useQuery","PERSONAL_TASK_QUERIES","TASKS","SUBTASKS","PersonalTaskRepository","_class","keys","root","task","id","mutation","create","delete","update","getList","_s","params","queryKey","queryFn","response","Promise","resolve","setTimeout","updateTask","_s2","queryClient","mutationKey","mutationFn","taskId","onSuccess","invalidateQueries","onMutate","console","log","getSubtasks","_s3","task_id"],"sources":["D:/Mega/Planner/frontend/src/entities/task/personal/repository.ts"],"sourcesContent":["import {IPersonalTask, PersonalTaskService, UpdateTaskProps} from \"@entities/task\";\r\nimport {QueryClient, useMutation, useQuery} from \"@tanstack/react-query\";\r\nimport {IPaginatorResponse} from \"@shared/api\";\r\nimport {ITaskStatus} from \"@entities/status\";\r\nimport {ITaskTag} from \"@entities/tag\";\r\n\r\nexport const PERSONAL_TASK_QUERIES = {\r\n    TASKS: \"personalTasks\",\r\n    SUBTASKS: \"personalSubtasks\",\r\n}\r\n\r\nexport class PersonalTaskRepository {\r\n    static keys = {\r\n        root: [\"personalTasks\"],\r\n        task: {\r\n            root: () => [...PersonalTaskRepository.keys.root, \"task\"],\r\n            id: (id: number) => [...PersonalTaskRepository.keys.task.root(), id],\r\n        },\r\n\r\n        mutation: {\r\n            create: () => [...PersonalTaskRepository.keys.root, \"create\"],\r\n            delete: () => [...PersonalTaskRepository.keys.root, \"delete\"],\r\n            update: () => [...PersonalTaskRepository.keys.root, \"update\"],\r\n        }\r\n\r\n    }\r\n\r\n    static getList = (params?: string) => useQuery <\r\n        IPaginatorResponse<IPersonalTask>,\r\n        Error,\r\n        IPaginatorResponse<IPersonalTask>,\r\n        string[]\r\n    >({\r\n        queryKey: PersonalTaskRepository.keys.root,\r\n        queryFn: async () => {\r\n            const response = await PersonalTaskService.getList(params);\r\n\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n            return response;\r\n        },\r\n    });\r\n\r\n    static updateTask = (queryClient: QueryClient) => useMutation<\r\n        IPersonalTask,\r\n        Error,\r\n        UpdateTaskProps<IPersonalTask<number, number>>,\r\n        unknown\r\n    >({\r\n        mutationKey: PersonalTaskRepository.keys.mutation.create(),\r\n        mutationFn: async ({taskId, task}) => {\r\n            const response = await PersonalTaskService.updateTask(taskId, task);\r\n\r\n            return response;\r\n        },\r\n        onSuccess: async () => {\r\n            await queryClient.invalidateQueries({\r\n                queryKey: PersonalTaskRepository.keys.root\r\n            });\r\n        },\r\n        onMutate: () => {\r\n            console.log(\"mutate\");\r\n        }\r\n    })\r\n\r\n    static getSubtasks = (task_id: number) => useQuery <\r\n        IPaginatorResponse<IPersonalTask>,\r\n        Error,\r\n        IPaginatorResponse<IPersonalTask>,\r\n        string[]\r\n    >({\r\n        queryKey: [PERSONAL_TASK_QUERIES.SUBTASKS],\r\n        queryFn: async () => {\r\n            const response = await PersonalTaskService.getSubtasks(task_id);\r\n\r\n            return response;\r\n        },\r\n    });\r\n}"],"mappings":";;;;AAAA,SAAuBA,mBAAmB,QAAwB,gBAAgB;AAClF,SAAqBC,WAAW,EAAEC,QAAQ,QAAO,uBAAuB;AAKxE,OAAO,MAAMC,qBAAqB,GAAG;EACjCC,KAAK,EAAE,eAAe;EACtBC,QAAQ,EAAE;AACd,CAAC;AAED,OAAO,MAAMC,sBAAsB,CAAC;AAmEnCC,MAAA,GAnEYD,sBAAsB;AAAtBA,sBAAsB,CACxBE,IAAI,GAAG;EACVC,IAAI,EAAE,CAAC,eAAe,CAAC;EACvBC,IAAI,EAAE;IACFD,IAAI,EAAEA,CAAA,KAAM,CAAC,GAAGH,MAAsB,CAACE,IAAI,CAACC,IAAI,EAAE,MAAM,CAAC;IACzDE,EAAE,EAAGA,EAAU,IAAK,CAAC,GAAGL,MAAsB,CAACE,IAAI,CAACE,IAAI,CAACD,IAAI,CAAC,CAAC,EAAEE,EAAE;EACvE,CAAC;EAEDC,QAAQ,EAAE;IACNC,MAAM,EAAEA,CAAA,KAAM,CAAC,GAAGP,MAAsB,CAACE,IAAI,CAACC,IAAI,EAAE,QAAQ,CAAC;IAC7DK,MAAM,EAAEA,CAAA,KAAM,CAAC,GAAGR,MAAsB,CAACE,IAAI,CAACC,IAAI,EAAE,QAAQ,CAAC;IAC7DM,MAAM,EAAEA,CAAA,KAAM,CAAC,GAAGT,MAAsB,CAACE,IAAI,CAACC,IAAI,EAAE,QAAQ;EAChE;AAEJ,CAAC;AAdQH,sBAAsB,CAgBxBU,OAAO,GAAAC,EAAA,CAAIC,MAAe;EAAAD,EAAA;EAAA,OAAKf,QAAQ,CAK5C;IACEiB,QAAQ,EAAEb,MAAsB,CAACE,IAAI,CAACC,IAAI;IAC1CW,OAAO,EAAE,MAAAA,CAAA,KAAY;MACjB,MAAMC,QAAQ,GAAG,MAAMrB,mBAAmB,CAACgB,OAAO,CAACE,MAAM,CAAC;MAE1D,MAAM,IAAII,OAAO,CAACC,OAAO,IAAIC,UAAU,CAACD,OAAO,EAAE,GAAG,CAAC,CAAC;MAEtD,OAAOF,QAAQ;IACnB;EACJ,CAAC,CAAC;AAAA;EAAA,QAdoCnB,QAAQ;AAAA;AAhBrCI,sBAAsB,CAgCxBmB,UAAU,GAAAC,GAAA,CAAIC,WAAwB;EAAAD,GAAA;EAAA,OAAKzB,WAAW,CAK3D;IACE2B,WAAW,EAAEtB,MAAsB,CAACE,IAAI,CAACI,QAAQ,CAACC,MAAM,CAAC,CAAC;IAC1DgB,UAAU,EAAE,MAAAA,CAAO;MAACC,MAAM;MAAEpB;IAAI,CAAC,KAAK;MAClC,MAAMW,QAAQ,GAAG,MAAMrB,mBAAmB,CAACyB,UAAU,CAACK,MAAM,EAAEpB,IAAI,CAAC;MAEnE,OAAOW,QAAQ;IACnB,CAAC;IACDU,SAAS,EAAE,MAAAA,CAAA,KAAY;MACnB,MAAMJ,WAAW,CAACK,iBAAiB,CAAC;QAChCb,QAAQ,EAAEb,MAAsB,CAACE,IAAI,CAACC;MAC1C,CAAC,CAAC;IACN,CAAC;IACDwB,QAAQ,EAAEA,CAAA,KAAM;MACZC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IACzB;EACJ,CAAC,CAAC;AAAA;EAAA,QApBgDlC,WAAW;AAAA;AAhCpDK,sBAAsB,CAsDxB8B,WAAW,GAAAC,GAAA,CAAIC,OAAe;EAAAD,GAAA;EAAA,OAAKnC,QAAQ,CAKhD;IACEiB,QAAQ,EAAE,CAAChB,qBAAqB,CAACE,QAAQ,CAAC;IAC1Ce,OAAO,EAAE,MAAAA,CAAA,KAAY;MACjB,MAAMC,QAAQ,GAAG,MAAMrB,mBAAmB,CAACoC,WAAW,CAACE,OAAO,CAAC;MAE/D,OAAOjB,QAAQ;IACnB;EACJ,CAAC,CAAC;AAAA;EAAA,QAZwCnB,QAAQ;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}