{"ast":null,"code":"var _class,\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { SpaceService } from \"@entities/space\";\nexport class SpaceRepository {}\n_class = SpaceRepository;\nSpaceRepository.keys = {\n  root: [\"space\"],\n  id: spaceId => [..._class.keys.root, spaceId],\n  me: {\n    root: () => [..._class.keys.root, \"me\"]\n  },\n  mutation: {\n    create: () => [..._class.keys.root, \"create\"],\n    delete: () => [..._class.keys.root, \"delete\"],\n    update: () => [..._class.keys.root, \"update\"]\n  }\n};\nSpaceRepository.getMy = _s(() => {\n  _s();\n  return useQuery({\n    queryKey: _class.keys.me.root(),\n    queryFn: async () => {\n      const response = await SpaceService.getMy();\n      await new Promise(resolve => setTimeout(resolve, 500));\n      return response;\n    },\n    retry: 3\n  });\n}, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nSpaceRepository.getById = _s2(spaceId => {\n  _s2();\n  return useQuery({\n    queryKey: _class.keys.me.root(),\n    queryFn: async () => {\n      const response = await SpaceService.getById(spaceId);\n      return response;\n    },\n    retry: 3\n  });\n}, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n  return [useQuery];\n});\nSpaceRepository.create = async task => {\n  try {\n    const response = await SpaceService.create(task);\n    return response;\n  } catch {\n    throw new Error(\"Произошла ошибка при создании\");\n  }\n};\nSpaceRepository.update = _s3((spaceId, queryClient) => {\n  _s3();\n  return useMutation({\n    mutationKey: _class.keys.mutation.update(),\n    mutationFn: async space => {\n      const response = await SpaceService.update(spaceId, space);\n      return response;\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({\n        queryKey: _class.keys.root\n      });\n    }\n  });\n}, \"wwwtpB20p0aLiHIvSy5P98MwIUg=\", false, function () {\n  return [useMutation];\n});","map":{"version":3,"names":["useMutation","useQuery","SpaceService","SpaceRepository","_class","keys","root","id","spaceId","me","mutation","create","delete","update","getMy","_s","queryKey","queryFn","response","Promise","resolve","setTimeout","retry","getById","_s2","task","Error","_s3","queryClient","mutationKey","mutationFn","space","onSuccess","invalidateQueries"],"sources":["D:/Mega/Planner/frontend/src/entities/space/repository.ts"],"sourcesContent":["import {QueryClient, useMutation, useQuery} from \"@tanstack/react-query\";\r\nimport {IPaginatorResponse} from \"@shared/api\";\r\nimport {ISpace, SpaceService} from \"@entities/space\";\r\nimport {IPersonalTask, ISpaceTask, PersonalTaskService, SpaceTaskService, UpdateTaskProps} from \"@entities/task\";\r\n\r\nexport class SpaceRepository {\r\n    static keys = {\r\n        root: [\"space\"],\r\n\r\n        id: (spaceId: number) => [...SpaceRepository.keys.root, spaceId],\r\n        me: {\r\n            root: () => [...SpaceRepository.keys.root, \"me\"],\r\n        },\r\n\r\n        mutation: {\r\n            create: () => [...SpaceRepository.keys.root, \"create\"],\r\n            delete: () => [...SpaceRepository.keys.root, \"delete\"],\r\n            update: () => [...SpaceRepository.keys.root, \"update\"],\r\n        }\r\n    }\r\n\r\n    static getMy = () => useQuery<\r\n        IPaginatorResponse<ISpace>,\r\n        Error\r\n    >({\r\n        queryKey: SpaceRepository.keys.me.root(),\r\n\r\n        queryFn: async () => {\r\n            const response = await SpaceService.getMy();\r\n\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n            return response;\r\n        },\r\n\r\n        retry: 3\r\n    });\r\n\r\n    static getById = (spaceId: number) => useQuery<\r\n        ISpace,\r\n        Error\r\n    >({\r\n        queryKey: SpaceRepository.keys.me.root(),\r\n\r\n        queryFn: async () => {\r\n            const response = await SpaceService.getById(spaceId);\r\n\r\n            return response;\r\n        },\r\n\r\n        retry: 3\r\n    });\r\n\r\n    static create = async (task: Partial<ISpace<number>>): Promise<ISpace> => {\r\n        try {\r\n            const response = await SpaceService.create(task);\r\n\r\n            return response;\r\n        }\r\n        catch {\r\n            throw new Error(\"Произошла ошибка при создании\");\r\n        }\r\n    };\r\n\r\n    static update = (spaceId: number, queryClient: QueryClient) => useMutation<\r\n        ISpace,\r\n        Error,\r\n        Partial<ISpace<number>>,\r\n        unknown\r\n        >({\r\n        mutationKey: SpaceRepository.keys.mutation.update(),\r\n        mutationFn: async (space) => {\r\n            const response = await SpaceService.update(spaceId, space);\r\n\r\n            return response;\r\n        },\r\n        onSuccess: async () => {\r\n            await queryClient.invalidateQueries({\r\n                queryKey: SpaceRepository.keys.root\r\n            });\r\n        },\r\n    });\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}