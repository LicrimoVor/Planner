{"ast":null,"code":"import { UserService } from \"@entities/user\";\nimport { create } from \"zustand\";\nimport { sessionStore } from \"@entities/session\";\nimport Cookies from \"js-cookie\";\nclass UserStore {\n  constructor() {\n    this.store = void 0;\n    this.useUser = () => this.store(state => state.user);\n    this.getMe = () => this.store.getState().getMe();\n    this.store = create((set, get) => ({\n      user: null,\n      getMe: async () => {\n        set({\n          user: null\n        });\n        try {\n          const response = await UserService.getMe();\n          sessionStore.setUser(Cookies.get(\"sessionid\"));\n          set({\n            user: response\n          });\n        } catch (error) {\n          var _response;\n          if ((error === null || error === void 0 ? void 0 : (_response = error.response) === null || _response === void 0 ? void 0 : _response.status) === 401) {\n            sessionStore.removeUser();\n          }\n        }\n      }\n    }));\n  }\n}\nexport const userStore = new UserStore();","map":{"version":3,"names":["UserService","create","sessionStore","Cookies","UserStore","constructor","store","useUser","state","user","getMe","getState","set","get","response","setUser","error","_response","status","removeUser","userStore"],"sources":["D:/Mega/Planner/frontend/src/entities/user/store.ts"],"sourcesContent":["import {IUser, UserService} from \"@entities/user\";\r\nimport {create} from \"zustand\";\r\nimport {AxiosError} from \"axios\";\r\nimport {sessionStore} from \"@entities/session\";\r\nimport Cookies from \"js-cookie\";\r\n\r\ninterface UserState {\r\n    user: IUser | null;\r\n\r\n    getMe: () => Promise<void>;\r\n}\r\n\r\nclass UserStore {\r\n    private readonly store;\r\n\r\n    constructor() {\r\n        this.store = create<UserState>((set, get) => ({\r\n            user: null,\r\n\r\n            getMe: async () => {\r\n                set({user: null});\r\n\r\n                try {\r\n                    const response = await UserService.getMe();\r\n                    sessionStore.setUser(Cookies.get(\"sessionid\")!);\r\n                    set({user: response});\r\n                }\r\n                catch (error) {\r\n                    if((error as AxiosError)?.response?.status === 401) {\r\n                        sessionStore.removeUser();\r\n                    }\r\n                }\r\n            }\r\n        }));\r\n    }\r\n\r\n    useUser = () => this.store(state => state.user);\r\n\r\n    getMe = () => this.store.getState().getMe();\r\n}\r\n\r\nexport const userStore = new UserStore();"],"mappings":"AAAA,SAAeA,WAAW,QAAO,gBAAgB;AACjD,SAAQC,MAAM,QAAO,SAAS;AAE9B,SAAQC,YAAY,QAAO,mBAAmB;AAC9C,OAAOC,OAAO,MAAM,WAAW;AAQ/B,MAAMC,SAAS,CAAC;EAGZC,WAAWA,CAAA,EAAG;IAAA,KAFGC,KAAK;IAAA,KAuBtBC,OAAO,GAAG,MAAM,IAAI,CAACD,KAAK,CAACE,KAAK,IAAIA,KAAK,CAACC,IAAI,CAAC;IAAA,KAE/CC,KAAK,GAAG,MAAM,IAAI,CAACJ,KAAK,CAACK,QAAQ,CAAC,CAAC,CAACD,KAAK,CAAC,CAAC;IAtBvC,IAAI,CAACJ,KAAK,GAAGL,MAAM,CAAY,CAACW,GAAG,EAAEC,GAAG,MAAM;MAC1CJ,IAAI,EAAE,IAAI;MAEVC,KAAK,EAAE,MAAAA,CAAA,KAAY;QACfE,GAAG,CAAC;UAACH,IAAI,EAAE;QAAI,CAAC,CAAC;QAEjB,IAAI;UACA,MAAMK,QAAQ,GAAG,MAAMd,WAAW,CAACU,KAAK,CAAC,CAAC;UAC1CR,YAAY,CAACa,OAAO,CAACZ,OAAO,CAACU,GAAG,CAAC,WAAW,CAAE,CAAC;UAC/CD,GAAG,CAAC;YAACH,IAAI,EAAEK;UAAQ,CAAC,CAAC;QACzB,CAAC,CACD,OAAOE,KAAK,EAAE;UAAA,IAAAC,SAAA;UACV,IAAG,CAACD,KAAK,aAALA,KAAK,wBAAAC,SAAA,GAALD,KAAK,CAAiBF,QAAQ,cAAAG,SAAA,uBAA/BA,SAAA,CAAiCC,MAAM,MAAK,GAAG,EAAE;YAChDhB,YAAY,CAACiB,UAAU,CAAC,CAAC;UAC7B;QACJ;MACJ;IACJ,CAAC,CAAC,CAAC;EACP;AAKJ;AAEA,OAAO,MAAMC,SAAS,GAAG,IAAIhB,SAAS,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}