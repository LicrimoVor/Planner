{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback } from \"react\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { useReactTable, getCoreRowModel, flexRender } from \"@tanstack/react-table\";\nimport { useTaskTableColumns } from \"@shared/hooks/table/useTaskTableColumns\";\nimport { useTaskFilter } from \"@shared/hooks\";\nexport function useTaskTable(props) {\n  _s();\n  const {\n    extendedColumns,\n    extendAfter,\n    queryKey,\n    filters,\n    apiGet,\n    apiGetSubtasks\n  } = props;\n  const queryClient = useQueryClient();\n  const {\n    params: filterParams\n  } = useTaskFilter({\n    filters: filters || {}\n  });\n  const {\n    data: response\n  } = apiGet(filterParams);\n  const tasks = (response === null || response === void 0 ? void 0 : response.results) || null;\n  const updateTable = useCallback(async () => {\n    await queryClient.resetQueries({\n      queryKey: [queryKey]\n    });\n  }, [queryClient, queryKey]);\n  const columns = useTaskTableColumns({\n    extendedColumns: extendedColumns || [],\n    extendAfter: extendAfter || 0,\n    apiGetSubtasks: apiGetSubtasks\n  });\n  const table = useReactTable({\n    columns: columns,\n    data: tasks || [],\n    getCoreRowModel: getCoreRowModel(),\n    enableColumnResizing: true,\n    columnResizeMode: \"onChange\"\n  });\n  const headers = table.getHeaderGroups()[0].headers.map(header => flexRender(header.column.columnDef.header, header.getContext()));\n  const rows = table.getRowModel().rows.map(row => row.getVisibleCells().map(cell => flexRender(cell.column.columnDef.cell, cell.getContext())));\n  return {\n    table,\n    headers,\n    rows,\n    tasks,\n    updateTable\n  };\n}\n_s(useTaskTable, \"k6eNbAY3YOzK9Y8tCOVGs8EPKBg=\", false, function () {\n  return [useQueryClient, useTaskFilter, useTaskTableColumns, useReactTable];\n});","map":{"version":3,"names":["useCallback","useQueryClient","useReactTable","getCoreRowModel","flexRender","useTaskTableColumns","useTaskFilter","useTaskTable","props","_s","extendedColumns","extendAfter","queryKey","filters","apiGet","apiGetSubtasks","queryClient","params","filterParams","data","response","tasks","results","updateTable","resetQueries","columns","table","enableColumnResizing","columnResizeMode","headers","getHeaderGroups","map","header","column","columnDef","getContext","rows","getRowModel","row","getVisibleCells","cell"],"sources":["D:/Mega/Planner/frontend/src/shared/hooks/table/useTaskTable.ts"],"sourcesContent":["import React, {useCallback} from \"react\";\r\nimport {useQueryClient, UseQueryResult} from \"@tanstack/react-query\";\r\nimport {IPaginatorResponse} from \"@shared/api\";\r\nimport {ColumnDef, useReactTable, getCoreRowModel, Table, flexRender} from \"@tanstack/react-table\";\r\nimport {useTaskTableColumns} from \"@shared/hooks/table/useTaskTableColumns\";\r\nimport {ITask} from \"@entities/task\";\r\nimport {useTaskFilter} from \"@shared/hooks\";\r\nimport {TaskFilter} from \"@shared/types\";\r\n\r\nexport function useTaskTable<Task extends ITask>(props: {\r\n    extendedColumns?: ColumnDef<Task, any>[];\r\n    extendAfter?: number;\r\n    queryKey: string;\r\n    filters?: Partial<TaskFilter>;\r\n\r\n    apiGet: (params?: string) => UseQueryResult<IPaginatorResponse<Task>>;\r\n    apiGetSubtasks: (task_id: number) => UseQueryResult<IPaginatorResponse<Task>>;\r\n    apiUpdateTask: (task_id: number, task: Partial<ITask<number, number>>) => Promise<void>;\r\n}): {\r\n    table: Table<Task>;\r\n    headers: (JSX.Element | React.ReactNode)[];\r\n    rows: (JSX.Element | React.ReactNode)[][];\r\n    tasks: Task[] | null;\r\n    updateTable: () => void;\r\n} {\r\n    const {\r\n        extendedColumns, extendAfter,\r\n        queryKey, filters,\r\n        apiGet, apiGetSubtasks,\r\n    } = props;\r\n\r\n    const queryClient = useQueryClient();\r\n\r\n    const {params: filterParams} = useTaskFilter({\r\n        filters: filters || {}\r\n    });\r\n\r\n    const {\r\n        data: response,\r\n    } = apiGet(filterParams);\r\n    const tasks = response?.results || null;\r\n\r\n    const updateTable = useCallback(async () => {\r\n        await queryClient.resetQueries({\r\n            queryKey: [queryKey]\r\n        });\r\n    }, [queryClient, queryKey]);\r\n\r\n    const columns = useTaskTableColumns<Task>({\r\n        extendedColumns: extendedColumns || [],\r\n        extendAfter: extendAfter || 0,\r\n\r\n        apiGetSubtasks: apiGetSubtasks,\r\n    });\r\n\r\n    const table = useReactTable({\r\n        columns: columns,\r\n        data: tasks || [],\r\n        getCoreRowModel: getCoreRowModel(),\r\n        enableColumnResizing: true,\r\n        columnResizeMode: \"onChange\"\r\n    });\r\n\r\n    const headers = table.getHeaderGroups()[0].headers.map(header =>\r\n        flexRender(header.column.columnDef.header, header.getContext())\r\n    );\r\n    const rows = table.getRowModel().rows.map(row =>\r\n        row.getVisibleCells().map(cell =>\r\n            flexRender(cell.column.columnDef.cell, cell.getContext())\r\n        )\r\n    );\r\n\r\n    return {\r\n        table,\r\n        headers,\r\n        rows,\r\n        tasks,\r\n        updateTable\r\n    }\r\n}"],"mappings":";AAAA,SAAeA,WAAW,QAAO,OAAO;AACxC,SAAQC,cAAc,QAAuB,uBAAuB;AAEpE,SAAmBC,aAAa,EAAEC,eAAe,EAASC,UAAU,QAAO,uBAAuB;AAClG,SAAQC,mBAAmB,QAAO,yCAAyC;AAE3E,SAAQC,aAAa,QAAO,eAAe;AAG3C,OAAO,SAASC,YAAYA,CAAqBC,KAShD,EAMC;EAAAC,EAAA;EACE,MAAM;IACFC,eAAe;IAAEC,WAAW;IAC5BC,QAAQ;IAAEC,OAAO;IACjBC,MAAM;IAAEC;EACZ,CAAC,GAAGP,KAAK;EAET,MAAMQ,WAAW,GAAGf,cAAc,CAAC,CAAC;EAEpC,MAAM;IAACgB,MAAM,EAAEC;EAAY,CAAC,GAAGZ,aAAa,CAAC;IACzCO,OAAO,EAAEA,OAAO,IAAI,CAAC;EACzB,CAAC,CAAC;EAEF,MAAM;IACFM,IAAI,EAAEC;EACV,CAAC,GAAGN,MAAM,CAACI,YAAY,CAAC;EACxB,MAAMG,KAAK,GAAG,CAAAD,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEE,OAAO,KAAI,IAAI;EAEvC,MAAMC,WAAW,GAAGvB,WAAW,CAAC,YAAY;IACxC,MAAMgB,WAAW,CAACQ,YAAY,CAAC;MAC3BZ,QAAQ,EAAE,CAACA,QAAQ;IACvB,CAAC,CAAC;EACN,CAAC,EAAE,CAACI,WAAW,EAAEJ,QAAQ,CAAC,CAAC;EAE3B,MAAMa,OAAO,GAAGpB,mBAAmB,CAAO;IACtCK,eAAe,EAAEA,eAAe,IAAI,EAAE;IACtCC,WAAW,EAAEA,WAAW,IAAI,CAAC;IAE7BI,cAAc,EAAEA;EACpB,CAAC,CAAC;EAEF,MAAMW,KAAK,GAAGxB,aAAa,CAAC;IACxBuB,OAAO,EAAEA,OAAO;IAChBN,IAAI,EAAEE,KAAK,IAAI,EAAE;IACjBlB,eAAe,EAAEA,eAAe,CAAC,CAAC;IAClCwB,oBAAoB,EAAE,IAAI;IAC1BC,gBAAgB,EAAE;EACtB,CAAC,CAAC;EAEF,MAAMC,OAAO,GAAGH,KAAK,CAACI,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC,CAACD,OAAO,CAACE,GAAG,CAACC,MAAM,IACzD5B,UAAU,CAAC4B,MAAM,CAACC,MAAM,CAACC,SAAS,CAACF,MAAM,EAAEA,MAAM,CAACG,UAAU,CAAC,CAAC,CAClE,CAAC;EACD,MAAMC,IAAI,GAAGV,KAAK,CAACW,WAAW,CAAC,CAAC,CAACD,IAAI,CAACL,GAAG,CAACO,GAAG,IACzCA,GAAG,CAACC,eAAe,CAAC,CAAC,CAACR,GAAG,CAACS,IAAI,IAC1BpC,UAAU,CAACoC,IAAI,CAACP,MAAM,CAACC,SAAS,CAACM,IAAI,EAAEA,IAAI,CAACL,UAAU,CAAC,CAAC,CAC5D,CACJ,CAAC;EAED,OAAO;IACHT,KAAK;IACLG,OAAO;IACPO,IAAI;IACJf,KAAK;IACLE;EACJ,CAAC;AACL;AAACd,EAAA,CAtEeF,YAAY;EAAA,QAsBJN,cAAc,EAEHK,aAAa,EAe5BD,mBAAmB,EAOrBH,aAAa;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}